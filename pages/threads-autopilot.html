<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate, max-age=0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="-1">
    <title>–ê–≤—Ç–æ–ø–∏–ª–æ—Ç - THREADS ZAVOD</title>
    <link rel="stylesheet" href="../assets/css/styles.css">
    <link rel="stylesheet" href="../assets/css/threads.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div id="app">
        <!-- Header -->
        <div class="header-gradient">
            <div class="header-back-button" id="back-button">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M15 18L9 12L15 6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <div class="header-title-block">
                <div class="header-title">ü§ñ –ê–í–¢–û–ü–ò–õ–û–¢</div>
                <div class="header-subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è–º–∏</div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="main-content">
            <div class="autopilot-container">
                
                <!-- Status Section -->
                <div class="status-section">
                    <div class="status-card">
                        <div class="status-indicator">
                            <span class="status-dot" id="autopilot-dot">üî¥</span>
                            <span class="status-text" id="autopilot-status">–ù–µ–∞–∫—Ç–∏–≤–µ–Ω</span>
                        </div>
                        <div class="account-info">
                            <span>–ê–∫–∫–∞—É–Ω—Ç: <span id="autopilot-account">–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω</span></span>
                        </div>
                    </div>
                </div>

                <!-- Setup Required (shown when not configured) -->
                <div class="setup-required" id="setup-required">
                    <div class="setup-card">
                        <div class="setup-icon">‚öôÔ∏è</div>
                        <div class="setup-content">
                            <h3>–ê–≤—Ç–æ–ø–∏–ª–æ—Ç –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</h3>
                            <p>–î–ª—è —Ä–∞–±–æ—Ç—ã –∞–≤—Ç–æ–ø–∏–ª–æ—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:</p>
                            <ul>
                                <li>‚úÖ –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç Threads</li>
                                <li>‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–π</li>
                                <li>‚úÖ –ó–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ò–ò-–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏</li>
                            </ul>
                            <button class="threads-button primary" id="setup-autopilot">
                                ‚öôÔ∏è –ù–ê–°–¢–†–û–ò–¢–¨ –ê–í–¢–û–ü–ò–õ–û–¢
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Active Autopilot (shown when configured) -->
                <div class="active-autopilot" id="active-autopilot" style="display: none;">
                    
                    <!-- Tabs Navigation -->
                    <div class="tabs-navigation">
                        <button class="tab-button active" data-tab="overview">üìä –û–±–∑–æ—Ä</button>
                        <button class="tab-button" data-tab="schedule">üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</button>
                        <button class="tab-button" data-tab="posts">‚úçÔ∏è –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç—ã</button>
                        <button class="tab-button" data-tab="queue">üìù –û—á–µ—Ä–µ–¥—å</button>
                    </div>

                    <!-- Tab Content: Overview -->
                    <div class="tab-content active" id="tab-overview">
                        <!-- Autopilot Status -->
                        <div class="status-section">
                            <div class="status-card">
                                <div class="status-info">
                                    <div class="status-dot" id="autopilot-dot">üî¥</div>
                                    <div class="status-text">
                                        <div class="status-title">–ê–≤—Ç–æ–ø–∏–ª–æ—Ç: <span id="autopilot-status">–ù–µ–∞–∫—Ç–∏–≤–µ–Ω</span></div>
                                        <div class="status-subtitle">–ê–∫–∫–∞—É–Ω—Ç: <span id="autopilot-account">–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Today's Posts -->
                        <div class="schedule-section">
                            <h4>üìÖ –°–µ–≥–æ–¥–Ω—è –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ</h4>
                            <div class="posts-list" id="today-posts">
                                <!-- Posts will be dynamically generated -->
                            </div>
                        </div>

                        <!-- Queue Info -->
                        <div class="queue-section">
                            <div class="queue-info">
                                üìù –í –æ—á–µ—Ä–µ–¥–∏: <span id="queue-count">0</span> –ø–æ—Å—Ç–æ–≤ –≥–æ—Ç–æ–≤—ã
                            </div>
                        </div>

                        <!-- Controls -->
                        <div class="controls-section">
                            <h4>üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</h4>
                            <div class="control-buttons">
                                <button class="control-button pause" id="pause-autopilot">
                                    ‚è∏Ô∏è –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∞–≤—Ç–æ–ø–∏–ª–æ—Ç
                                </button>
                                <button class="control-button clear" id="clear-schedule">
                                    üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
                                </button>
                                <button class="control-button test" id="test-publish" onclick="testPublishNow()">
                                    üß™ –¢–µ—Å—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Tab Content: Schedule -->
                    <div class="tab-content" id="tab-schedule">
                        <div class="schedule-manager">
                            <h4>üìÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º</h4>
                            
                            <div class="schedule-controls">
                                <div class="posts-count-control">
                                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤ –≤ –¥–µ–Ω—å:</label>
                                    <div class="count-selector">
                                        <button class="count-btn" data-count="1">1</button>
                                        <button class="count-btn" data-count="3">3</button>
                                        <button class="count-btn active" data-count="6">6</button>
                                        <button class="count-btn" data-count="10">10</button>
                                        <input type="number" id="custom-count" min="1" max="10" placeholder="–°–≤–æ–µ">
                                    </div>
                                </div>

                                <div class="time-distribution">
                                    <label>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏:</label>
                                    <div class="distribution-buttons">
                                        <button class="dist-btn active" data-mode="auto">ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</button>
                                        <button class="dist-btn" data-mode="manual">‚úã –í—Ä—É—á–Ω—É—é</button>
                                        <button class="dist-btn" data-mode="random">üé≤ –°–ª—É—á–∞–π–Ω–æ</button>
                                    </div>
                                </div>
                            </div>

                            <div class="schedule-preview" id="schedule-preview">
                                <!-- Schedule table will be generated here -->
                            </div>

                            <div class="schedule-actions">
                                <button class="threads-button secondary" id="regenerate-schedule">üîÑ –ü–µ—Ä–µ—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
                                <button class="threads-button primary" id="apply-schedule">üíæ –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</button>
                            </div>
                        </div>
                    </div>

                    <!-- Tab Content: Create Posts -->
                    <div class="tab-content" id="tab-posts">
                        <div class="posts-generator">
                            <h4>‚úçÔ∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤</h4>
                            
                            <div class="generation-controls">
                                <div class="posts-quantity">
                                    <label>–°–∫–æ–ª—å–∫–æ –ø–æ—Å—Ç–æ–≤ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å:</label>
                                    <select id="generate-count">
                                        <option value="1">1 –ø–æ—Å—Ç</option>
                                        <option value="3">3 –ø–æ—Å—Ç–∞</option>
                                        <option value="5" selected>5 –ø–æ—Å—Ç–æ–≤</option>
                                        <option value="10">10 –ø–æ—Å—Ç–æ–≤</option>
                                    </select>
                                </div>
                            </div>

                            <button class="threads-button primary generate-btn" id="generate-posts">
                                üßµ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Threads
                            </button>

                            <div class="generated-posts" id="generated-posts">
                                <!-- Generated posts will appear here -->
                            </div>
                        </div>
                    </div>

                    <!-- Tab Content: Queue -->
                    <div class="tab-content" id="tab-queue">
                        <div class="queue-manager">
                            <h4>üìù –û—á–µ—Ä–µ–¥—å –ø—É–±–ª–∏–∫–∞—Ü–∏–π</h4>
                            
                            <div class="queue-controls">
                                <button class="threads-button secondary" id="clear-queue">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –æ—á–µ—Ä–µ–¥—å</button>
                                <button class="threads-button primary" id="add-to-queue">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ—Å—Ç</button>
                            </div>

                            <div class="queue-list" id="queue-list">
                                <!-- Queue items will be displayed here -->
                            </div>
                        </div>
                    </div>

                    <!-- Publishing Calendar -->
                    <div class="calendar-section" id="calendar-section" style="display: none;">
                        <h4>üóìÔ∏è –ö–ê–õ–ï–ù–î–ê–†–¨ –ü–£–ë–õ–ò–ö–ê–¶–ò–ô</h4>
                        <div class="publishing-calendar" id="publishing-calendar">
                            <!-- Calendar will be generated here -->
                        </div>
                        <div class="calendar-legend">
                            <div class="legend-item">
                                <span class="legend-dot active">‚óè</span>
                                <span>–ê–∫—Ç–∏–≤–Ω—ã–µ –¥–Ω–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–π</span>
                            </div>
                            <div class="legend-item">
                                <span class="legend-dot published">‚úÖ</span>
                                <span>–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã</span>
                            </div>
                            <div class="legend-item">
                                <span class="legend-dot scheduled">‚è≥</span>
                                <span>–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã</span>
                            </div>
                        </div>
                    </div>
                </div>


            </div>
        </main>

        <!-- Schedule Editor Modal -->
        <div class="modal-overlay" id="schedule-modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üìÖ –†–µ–¥–∞–∫—Ç–æ—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</h3>
                    <button class="modal-close" id="close-schedule-modal">‚úï</button>
                </div>
                
                <div class="modal-body">
                    <!-- Schedule Type Selection -->
                    <div class="schedule-type-section">
                        <h4>–¢–∏–ø —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è:</h4>
                        <div class="type-buttons">
                            <button class="type-button active" data-type="daily">üìÜ –ï–∂–µ–¥–Ω–µ–≤–Ω–æ</button>
                            <button class="type-button" data-type="custom">üéØ –í—ã–±–æ—Ä–æ—á–Ω–æ</button>
                        </div>
                    </div>

                    <!-- Daily Schedule -->
                    <div class="daily-schedule" id="daily-schedule">
                        <h4>–ü—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ –¥–µ–Ω—å:</h4>
                        <div class="posts-input">
                            <input type="number" id="daily-posts" min="1" max="10" value="6">
                            <span>–ø–æ—Å—Ç–æ–≤ –≤ –¥–µ–Ω—å</span>
                        </div>
                        
                        <h4>–í—Ä–µ–º—è –ø—É–±–ª–∏–∫–∞—Ü–∏–π:</h4>
                        <div class="time-slots" id="daily-time-slots">
                            <!-- Time slots will be generated here -->
                        </div>
                        <button class="add-time-btn" id="add-daily-time">+ –î–æ–±–∞–≤–∏—Ç—å –≤—Ä–µ–º—è</button>
                    </div>

                    <!-- Custom Schedule -->
                    <div class="custom-schedule" id="custom-schedule" style="display: none;">
                        <h4>–í—ã–±–µ—Ä–∏—Ç–µ –¥–Ω–∏ –∏ –≤—Ä–µ–º—è:</h4>
                        <div class="calendar-editor" id="calendar-editor">
                            <!-- Calendar will be generated here -->
                        </div>
                    </div>


                </div>
                
                <div class="modal-footer">
                    <button class="btn-secondary" id="cancel-schedule">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn-primary" id="save-schedule">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="../assets/js/threads-api.js"></script>
    <script src="../assets/js/openai-service.js"></script>
    <script src="../assets/js/threads-autopilot.js"></script>
</body>
</html>